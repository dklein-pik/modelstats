---
title: "Testing Suite"
author: "Anastasis Giannousakis"
date: "5/21/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



## Introduction

This is an introduction to the Testing Suite for big models developed at PIK RD3. For big models no standard continuous integration (CI) techniques can be deployed, and unit tests are not easy to apply. We therefore developed a custom Testing Suite.

The Testing Suite tests several scenarios, including various output routines and interfaces with input data preparation. Further, it checks the data for consistency.

It is fully automated (runs every weekend) and writes reports in a gitlab project and sends a weekly email with each new report to the team developing the model.

## How it works:

A scheduled and recurring job runs on the cluster every weekend, starting model runs according to a `scenario_config_AMT.csv` (found as always in the model's `config` folder). AMT stands for "automated model tests". Once the runs are finished the job creates an overview of the results using [rs2](http://htmlpreview.github.io/?https://github.com/pik-piam/modelstats/blob/master/vignettes/rs2.html), and additionally runs [compareScenarios](https://github.com/pik-piam/remind2/blob/master/R/compareScenarios.R) comparing each run with the previous one with the same scenario name (the comparison PDF files are found in each scenario folder, they also contain comparisons with historical data). It also uploads all runs to the [shinyResults::appResults](https://github.com/pik-piam/shinyresults/blob/master/R/appResults.R) app for easy and interactive viewing (use "AMT" in the title search). Also here a comparison with historical data is found. Further, the results of all runs are gathered, passed through an [IAMC-style](https://github.com/IAMconsortium/iamc) check for consistency, and archived. These checks include:

  *  non-standard variable names
  *  missing variables
  *  min and max values
  *  summation groups (using the |+| notation)
  *  units

## How to contribute:

Add your own scenarios to the `scenario_config_AMT.csv` and simply commit it to the model's develop branch. This way your scenarios will be included in future tests.

Tailor the IAMC-style checks to your needs or add further IAMC-style checks here (read the vignette to see how this is done): http://htmlpreview.github.io/?https://github.com/pik-piam/piamModelTests/blob/master/vignettes/iamc.html

For wishes, changes etc, please contact RSE or open a new issue here: https://github.com/pik-piam/modelstats/issues


